filter {
  if [type] == "unicorn_access" {
        grok {
          match => [ "message", "%{UNICORN_NO_HEADER_LOG}|%{UNICORN_ANY_HEADER_LOG}|%{UNICORN_WARN_HEADER_LOG}|%{UNICORN_DEBUG_HEADER_LOG}" ]
        }
        grok {
          match => [ "path", "ip-%{DNS_IPV4:host_ip}.log" ]
        }
        date {
          match => ["timestamp", "ISO8601", "UNIX" ]
        }
        json {
          source => "json_blob"
          remove_field => [ "json_blob" ]
          remove_field => [ "message" ]
        }
  }
  else if [type] == "unicorn_error" {
    mutate { replace => {type => "error"} }
  }
  else {
    mutate { replace => {type => "random_logs"} }
  }
}
